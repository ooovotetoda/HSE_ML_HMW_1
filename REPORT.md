# Отчёт

### 1. EDA и предобработка данных

- **Загрузка данных:** загружены тренировочный и тестовый датасеты
- **Анализ пропусков:** выявлены пропуски в столбцах `mileage`, `engine`, `max_power`, `seats`. Заполнены медианами
- **Удаление дубликатов:** найдены и удалены объекты с одинаковым признаковым описанием
- **Удаление столбца `torque`:** убрали столбец (быстрое решение)
- **Типизация признаков:** числовые признаки (`year`, `km_driven`, `mileage`, `engine`, `max_power`, `seats`) выделены для дальнейшей работы
- **ydata-profiling:** построен интерактивный дашборд для автоматического EDA

### 2. Визуализации

- Построены гистограммы распределений числовых признаков
- Матрица корреляций для анализа взаимосвязей
- Boxplot для анализа выбросов
- Сравнение распределений train/test

### 3. Моделирование (вещественные признаки)

- Обучена **LinearRegression**
- Применена **StandardScaler** нормализация признаков
- Обучена **Lasso** регрессия
- Подбор гиперпараметров через **GridSearchCV**
- Обучена **ElasticNet** через **GridSearchCV**

### 4. Добавление категориальных признаков

- Применён **OneHotEncoder** к категориальным признакам (`fuel`, `seller_type`, `transmission`, `owner`, `seats`)
- Обучена **Ridge** регрессия с GridSearchCV на расширенном наборе признаков

### 5. Бизнес-метрика

- Реализована кастомная бизнес-метрика для оценки моделей
- Проведено сравнение всех моделей по данной метрике

### 6. Streamlit приложение

- Разработано веб-приложение для интерактивной работы с моделью
- Реализована загрузка CSV-файлов с данными
- Добавлены EDA-визуализации (гистограммы, корреляции, boxplot)
- Форма для ввода характеристик автомобиля и получения предсказания
- Визуализация коэффициентов обученной модели

---

## Метрики

| Модель | R² Train | R² Test | MSE Test |
|--------|----------|---------|----------|
| LinearRegression (числовые) | 0.592 | 0.594 | 2.33×10¹¹ |
| Lasso (default) | 0.592 | 0.594 | 2.33×10¹¹ |
| Lasso (GridSearchCV) | 0.589 | 0.582 | 2.41×10¹¹ |
| ElasticNet (GridSearchCV) | 0.588 | 0.572 | 2.46×10¹¹ |
| **Ridge (GridSearchCV + OHE)** | **0.654** | **0.646** | **2.04×10¹¹** |

### Бизнес-метрика

| Модель | Значение |
|--------|----------|
| LinearRegression | **0.249** |
| Lasso (GridSearchCV) | 0.230 |
| ElasticNet (GridSearchCV) | 0.242 |
| Ridge (GridSearchCV) | 0.242 |

**Лучшая модель по бизнес-метрике:** LinearRegression (0.249)

---

## Что дало наибольший прирост качества

1. **Добавление категориальных признаков через OneHotEncoder** — прирост R² на ~6% (с 0.59 до 0.65). Это позволило модели учитывать информацию о типе топлива, трансмиссии, продавце и количестве владельцев.

2. **GridSearchCV** — позволил подобрать оптимальные гиперпараметры регуляризации.

---

## Что сделать не удалось и почему

1. **Столбец `name`** — не был включён как признак для обучения, т. к. содержит слишком много уникальных значений. Потенциально можно было извлечь марку автомобиля как отдельный признак.

2. **Столбец `torque`** — имеет сложный текстовый формат с единицами измерения и диапазонами. Парсинг требует значительных усилий.

---

## Оценка разработанного сервиса

### Удобство использования

- **Плюсы:**
  - Простой и понятный интерфейс
  - Возможность загрузки кастомного CSV датасета для отображения аналитики
  - Возможность быстро получить предсказание
  - Интерактивные графики

- **Минусы:**
  - Хотелось бы передавать данные для прогнозирования через CSV файлик
  - Нет валидации введённых данных
  - Мало графиков

### Визуализации

- **Хорошо получилось:**
  - Гистограмма распределения целевой переменной
  - Тепловая карта корреляций
  - Boxplot по категориям
  - Горизонтальный bar-chart коэффициентов модели

- **Менее удачно:**
  - Отсутствуют визуализации для анализа предсказаний
  - Нет интерактивного выбора признаков для визуализации

### Ограничения и проблемы

1. Предсказания могут быть отрицательными для старых авто с большим пробегом
2. При загрузке CSV с новыми категориями модель не сможет их обработать

### Планируемые улучшения

1. Добавить валидацию входных данных
2. Реализовать визуализацию для анализа предсказаний
3. Засунуть всё в 1 полноценный pipeline
4. Зарефакторить работу с признаками (заполнение пропусков ,кодирование, масштабирование). Сделать её более структурированной и последовательной

---

## Заключение

В ходе работы была построена модель линейной регрессии для предсказания стоимости автомобилей. Лучший результат по метрике R² (0.646) показала Ridge-регрессия с OHE-кодированием категориальных признаков. По бизнес-метрике лучший результат (0.249) показала базовая LinearRegression. Разработано интерактивное Streamlit-приложение для работы с моделью.
